<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard - Student Lab System</title>
    <link rel="stylesheet" href="/styles/common.css">
    <link rel="stylesheet" href="/styles/admin-dashboard.css">
    <link href="/libraries/font-awesome.min.css" rel="stylesheet">
</head>
<body>
    <div class="dashboard-container">
        <!-- Header -->
        <header class="dashboard-header">
            <div class="header-left">
                <h1>Admin Dashboard</h1>
            </div>
            <div class="header-right">
                <a href="/data-collection-manager" class="data-collection-btn" title="Data Collection Manager">
                    <i class="fas fa-database"></i>
                    Data Collection
                </a>
                <div id="connection-status" class="status-pill disconnected">
                    <span class="status-dot"></span>
                    <span class="status-text">Disconnected</span>
                </div>
            </div>
        </header>

        <!-- Overview Cards -->
        <section class="overview-section">
            <div class="overview-card" id="total-students">
                <div class="card-number">0</div>
                <div class="card-label">Total Students</div>
            </div>
            <div class="overview-card" id="active-scanners">
                <div class="card-number">0</div>
                <div class="card-label">Active Scanners</div>
            </div>
            <div class="overview-card" id="todays-registrations">
                <div class="card-number">0</div>
                <div class="card-label">Today's Registrations</div>
            </div>
            <div class="overview-card" id="system-errors">
                <div class="card-number">0</div>
                <div class="card-label">System Errors</div>
            </div>
        </section>

        <!-- Two Column Row -->
        <section class="main-content">
            <!-- System Status -->
            <div class="content-card system-status-card">
                <h3>System Status</h3>
                <div class="status-list">
                    <div class="status-item">
                        <span class="status-label">Excel Database</span>
                        <span class="status-value" id="database-status">Connected</span>
                    </div>
                    <div class="status-item">
                        <span class="status-label">Uptime</span>
                        <span class="status-value" id="system-uptime">00:00</span>
                    </div>
                </div>
            </div>

            <!-- Quick Actions -->
            <div class="content-card quick-actions-card">
                <h3>Quick Actions</h3>
                <div class="action-buttons">
                    <a href="/entry-scanner" class="action-btn entry-scanner-btn">
                        Entry Scanner
                    </a>
                    <a href="/exit-validator" class="action-btn exit-validator-btn">
                        Exit Validator
                    </a>
                    <button id="download-exit-table" class="action-btn exit-table-btn">
                        <i class="fas fa-download"></i>
                        Download Exit Table
                    </button>
                </div>
            </div>
        </section>

        <!-- Auto Excel Import Status -->
        <section class="auto-import-section">
            <div class="content-card">
                <div class="import-status-header">
                    <h3>Auto Excel Import</h3>
                    <div class="import-status-indicator">
                        <i class="fas fa-folder-open"></i>
                        <span>Monitoring Student-Data folder</span>
                    </div>
                </div>
                <div class="import-status-content">
                    <div class="status-info">
                        <p><strong>Automatic Import:</strong> Excel files placed in the <code>Student-Data/</code> folder will be automatically detected and imported.</p>
                        <p><strong>Supported Formats:</strong> .xlsx, .xls, .csv</p>
                        <p><strong>Scan Frequency:</strong> Every 30 seconds</p>
                        <p><strong>Processed Files:</strong> Moved to <code>Student-Data/processed/</code> folder</p>
                    </div>
                    <div class="import-logs" id="import-logs">
                        <h5>Recent Import Activity</h5>
                        <div class="logs-container" id="import-logs-container">
                            <div class="log-entry log-info">
                                <span class="log-timestamp">[System Ready]</span>
                                <span class="log-message">Auto import system monitoring Student-Data folder...</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Live Devices -->
        <section class="live-devices-section">
            <div class="content-card">
                <div class="devices-header">
                    <h3>Live Devices</h3>
                    <div class="devices-summary">
                        <span id="devices-count">0 of 0 devices online</span>
                        <button id="refresh-devices" class="refresh-btn" title="Refresh device list">
                            <i class="fas fa-sync-alt"></i>
                        </button>
                    </div>
                </div>
                <div class="devices-content">
                    <div id="devices-list" class="devices-list">
                        <div class="device-placeholder">
                            <i class="fas fa-spinner fa-spin"></i>
                            <span>Loading devices...</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- System Logs -->
        <section class="system-logs-section">
            <div class="content-card">
                <div class="logs-header">
                    <h3>System Logs</h3>
                    <div class="logs-controls">
                        <button id="clear-logs" class="control-btn">
                            <i class="fas fa-trash"></i>
                            Clear
                        </button>
                        <button id="export-logs" class="control-btn">
                            <i class="fas fa-download"></i>
                            Export
                        </button>
                        <select id="log-level-filter" class="log-filter">
                            <option value="all">All Levels</option>
                            <option value="info">Info</option>
                            <option value="success">Success</option>
                            <option value="warning">Warning</option>
                            <option value="error">Error</option>
                        </select>
                    </div>
                </div>
                <div class="logs-content">
                    <div id="logs-container" class="logs-container">
                        <div class="log-entry log-info">
                            <span class="log-timestamp">[Loading...]</span>
                            <span class="log-message">System initializing...</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <!-- Permanent Manual Reconnect Button -->
    <div id="permanent-reconnect-bar" class="permanent-reconnect-bar">
        <div class="reconnect-content">
            <div class="reconnect-info">
                <i class="fas fa-wifi"></i>
                <span id="reconnect-status-text">Connection Status</span>
            </div>
            <div class="reconnect-actions">
                <button id="permanent-reconnect-btn" class="btn btn-reconnect">
                    <i class="fas fa-sync-alt"></i>
                    Reconnect
                </button>
                <button id="permanent-refresh-btn" class="btn btn-refresh">
                    <i class="fas fa-refresh"></i>
                    Refresh
                </button>
            </div>
        </div>
    </div>

    <!-- Manual Reconnect Button -->
    <div id="reconnect-overlay" class="reconnect-overlay" style="display: none;">
        <div class="reconnect-panel">
            <div class="reconnect-header">
                <i class="fas fa-wifi"></i>
                <h3>Connection Lost</h3>
            </div>
            <div class="reconnect-content">
                <p>Unable to connect to the server. Please check your connection and try again.</p>
                <div class="reconnect-actions">
                    <button id="manual-reconnect-btn" class="btn btn-primary">
                        <i class="fas fa-sync-alt"></i>
                        Reconnect Now
                    </button>
                    <button id="refresh-page-btn" class="btn btn-secondary">
                        <i class="fas fa-refresh"></i>
                        Refresh Page
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script src="/libraries/xlsx.full.min.js"></script>
    <script src="/scripts/Admin-Dashboard.js"></script>
</body>
</html>